<HTML>

<HEAD>
<TITLE>Trabalho de "Compiladores" - Ricardo Voigt</TITLE>
</HEAD>

<script language="Javascript">

var i = 0;
var lookahead = "";
var token = "";
var tipo_token = "";

function Numero(str)
{
   var checknum = parseInt(str);
   return !isNaN(checknum);
}

function Letra(str)
{
   switch(str)
   {
      case "A":
      case "B":
      case "C":
      case "D":
      case "E":
      case "F":
      case "G":
      case "H":
      case "I":
      case "J":
      case "K":
      case "L":
      case "M":
      case "N":
      case "O":
      case "P":
      case "Q":
      case "R":
      case "S":
      case "T":
      case "U":
      case "V":
      case "W":
      case "X":
      case "Y":
      case "Z": return (true);
                break;
      default: return (false);
   }
}

function move_lookahead()
{
   i = i + 1;

   if(i - 1 == document.frmEditor.Texto.value.length)
   {
      return "#";
   }
   else
   {
      return document.frmEditor.Texto.value.substr(i - 1, 1).toUpperCase();
   }
}

function BuscaProximoToken()
{
   token = "";

   while(lookahead == " " || lookahead.charCodeAt(0) == 10 || lookahead.charCodeAt(0) == 13 || lookahead.charCodeAt(0) == 9)
      lookahead = move_lookahead();

   if(Letra(lookahead))
   {
      token = lookahead;
      lookahead = move_lookahead();

      while(Letra(lookahead) || Numero(lookahead) || lookahead == "_")
      {
         token = token + lookahead;
         lookahead = move_lookahead();
      }
      
      if(token == "VARIAVEIS")
         tipo_token = "T_VARIAVEIS         ";
      else
      if(token == "INICIO")
         tipo_token = "T_INICIO            ";
      else
      if(token == "FIM")
         tipo_token = "T_FIM               ";
      else
      if(token == "ESCREVA")
         tipo_token = "T_ESCREVA           ";
      else
         tipo_token = "T_ID                ";
   }
   else
   {
      if(Numero(lookahead))
      {
         token = "";
         while(Numero(lookahead))
         {
            token = token + lookahead;
            lookahead = move_lookahead();
         }
      
         tipo_token = "T_NUMERO            ";
      }
      else
      {
         switch(lookahead)
         {
            case ",": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_VIRGULA           ";
                      break;

            case ";": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_PONTO_VIRGULA     ";
                      break;

            case "+": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_MAIS              ";
                      break;

            case "-": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_MENOS             ";
                      break;

            case "*": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_VEZES             ";
                      break;

            case "/": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_SOBRE             ";
                      break;

            case "(": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_ABREPAR           ";
                      break;

            case ")": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_FECHAPAR          ";
                      break;

            case ":": token = lookahead;
                      lookahead = move_lookahead();
                      if(lookahead == "=")
                      {
                         token = token + lookahead;
                         lookahead = move_lookahead();
                         tipo_token = "T_ATRIBUICAO        ";
                      }
                      else
                         tipo_token = "T_DOIS_PONTOS       ";
                      break;

            case "=": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_IGUAL             ";
                      break;

            case "<": token = lookahead;
                      lookahead = move_lookahead();
                      if(lookahead == "=")
                      {
                         token = token + lookahead;
                         lookahead = move_lookahead();
                         tipo_token = "T_MENOR_IGUAL       ";
                      }
                      else
                      if(lookahead == ">")
                      {
                         token = token + lookahead;
                         lookahead = move_lookahead();
                         tipo_token = "T_DIFERENTE         ";
                      }
                      else
                         tipo_token = "T_MENOR             ";
                      break;

            case ">": token = lookahead;
                      lookahead = move_lookahead();
                      if(lookahead == "=")
                      {
                         token = token + lookahead;
                         lookahead = move_lookahead();
                         tipo_token = "T_MAIOR_IGUAL       ";
                      }
                      else
                         tipo_token = "T_MAIOR             ";
                      break;

            case "#": token = lookahead;
                      lookahead = move_lookahead();
                      tipo_token = "T_FIM_FONTE         ";
                      break;

            default: token = lookahead;
                     lookahead = move_lookahead();
                     while(lookahead != " " && lookahead != "#" && lookahead.charCodeAt(0) != 10 && lookahead.charCodeAt(0) != 13 && lookahead.charCodeAt(0) != 9)
                     {
                        token = token + lookahead;
                        lookahead = move_lookahead();
                     }
                     tipo_token = "T_ERRO_LEXICO       ";
         }
      }
   }
}

function Analisa()
{
   var resultado = "";

   i = 0;

   lookahead = move_lookahead();
   BuscaProximoToken();
   while(tipo_token != "T_FIM_FONTE         ")
   {
      resultado = resultado + "<br>Token encontrado: " + tipo_token + " -> '" + token + "'";
      BuscaProximoToken();
   }
   resultado = resultado + "<br>Token encontrado: " + tipo_token + " -> '" + token + "'";

   document.write("Resultado da análise:<BR><PRE>" + resultado + "</PRE>");      
}
</script>

<BODY ONLOAD="frmEditor.Texto.focus()">
<font face="Courier New" size=2>
<CENTER>
<B>CENTRO UNIVERSITÁRIO FEEVALE</B><BR>
Trabalho de "Compiladores" - Ciência da Computação<BR>
2003/01 - 4N - Prédio Branco sala 304<BR>
Prof. Ricardo Ferreira de Oliveira<BR>
Análise Léxica<BR>
<B>RICARDO VOIGT</B><BR>
0003903<BR>
<BR>

<FORM NAME="frmEditor">
<TEXTAREA NAME="Texto" rows=13 wrap=virtual cols=80></TEXTAREA><BR>
<INPUT TYPE="BUTTON" NAME="btnAnalisa" VALUE="Analisa" ONCLICK="Javascript:Analisa()"><BR>
</FORM>
<BR>
Novo Hamburgo, Abril de 2003.
</CENTER>
<BR>

Este analisador segue os seguintes principios:<BR>
- Nao é CaseSensitive.<BR>
- Mantem um lookahead para ter em memoria o proximo caracter lido.<BR>
- A cada passo, consome um token avancando lookahead por todo token ate apontar para um caracter apos o token.<BR>
- Classifica o token e alimenta a variavel 'token' com o seu valor. Alimenta tambem a variavel tipo_token com o seu tipo correspondente.<BR>
<BR>

Gramatica:<BR>
---------<BR>
programa    -> 'VARIAVEIS' variaveis 'INICIO' comandos 'FIM'<BR>

variaveis   -> variaveis ',' variavel<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| variavel<BR>

variavel    -> 'ID'<BR>

comandos    -> comandos ';' comando<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| comando<BR>

comando     -> atribuicao<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| escrita<BR>

atribuicao  -> 'ID' ':=' expressao<BR>

escrita     -> 'ESCREVA' '(' variavel ')'<BR>

expressao   -> expressao '+' termo<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| expressao '-' termo<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| termo<BR>

termo       -> termo * unario<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| termo / unario<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| unario<BR>

unario      -> '+' fator<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| '-' fator<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| fator<BR>

fator       -> 'NUMERO'<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 'ID'<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| '(' expressao ')'<BR>

</BODY>
</HTML>